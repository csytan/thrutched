{% extends "base.html" %}


{% block title %}
    <title>Thrutched | {{ escape(video.title) }}</title>
{% end %}


{% block script %}
    <script src="http://connect.facebook.net/en_US/all.js#xfbml=1"></script>
    <script>
        jQuery(function($){
            FB.Event.subscribe('edge.create', function(response) {
                $.post(location.href, {action: 'like'});
            });
            
            $('a.like, a.dislike').live('click', function(){
                var link = $(this).fadeOut();
                $.post(this.href, function(data){
                    link.parent()
                        .find('span.points')
                        .fadeOut(function(){
                            $(this).text(data).fadeIn();
                        });
                });
                return false;
            });
            
            $('a.reply').live('click', function(){
                $('#reply_to').val($(this).data('id'));
                $('#reply_box')
                    .insertAfter($(this).closest('.body'))
                    .toggle('fast')
                    .find('textarea')
                    .focus();
                return false;
            });
        });
    </script>
{% end %}


{% block style %}
    <style>
        h1.title {
            margin-top: 1em;
            margin-bottom: 0.5em;
        }
        iframe.video {
            width: 100%;
            height: 540px;
        }
        a.vid_thumb {
            float: right;
            margin-top: 2em;
        }
        a.vid_thumb .title {
            top: 90px;
        }
        
        .description {
            padding-top: 10px;
            width: 600px;
            text-align: justify;
        }
        #reply_box { display: none; }
        #reply_box .body { width: 75%; }
        #reply_box textarea {
            width: 100%;
            height: 100px;
        }
    </style>
{% end %}


{% block content %}
    {% if video.youtube %}
        <iframe src="http://www.youtube.com/embed/{{ video.youtube }}?hd=1" class="video" frameborder="0"></iframe>
    {% elif video.vimeo %}
        <iframe src="http://player.vimeo.com/video/{{ video.vimeo }}" class="video" frameborder="0"></iframe>
    {% end %}
    
    {% if next_vid %}
        <a class="vid_thumb" href="/{{ next_vid.key().id() }}">
            <img src="{{ next_vid.thumbnail }}">
            <span class="title">Next...<br> {{ next_vid.title }}</span>
        </a>
    {% end %}

    <h1 class="title">{{ escape(video.title) }}</h1>
    

    
    <p class="description">{{ escape(video.text) }}</p>
    <fb:like href="" send="false" width="450" show_faces="false" font=""></fb:like>
    <div style="clear:both"></div>
    
    
    <h2>Comments</h2>
    
    {{ handler.render_comments(replies) }}
{% end %}

